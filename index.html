<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>To MDN</title>
		<style>
			* {
				-webkit-box-sizing: border-box;
				-moz-box-sizing: border-box;
				box-sizing: border-box;
			}
			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
					Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue",
					sans-serif;
			}
			table {
				border-collapse: collapse;
				border-spacing: 0;
			}
			th {
				vertical-align: bottom;
				border-bottom: 2px solid #ea411c;
				padding: 8px;
				line-height: 1.42857143;
				text-align: left;
			}
			td {
				padding: 8px;
				line-height: 1.42857143;
				vertical-align: top;
				border-top: 1px solid #ddd;
			}
			a {
				color: #14213d;
			}
		</style>
	</head>
	<body>
		<section style="width: 980px; margin: auto">
			<h1 style="border-bottom: 4px solid #ea411c; width: min-content">
				Hello!
			</h1>
			<p>
				This site exists to get you to relevant MDN web documentation
				ASAP. Here are some ways to use the site.
			</p>
			<table style="border-spacing: 10px">
				<thead>
					<tr>
						<th>By accessing this URL...</th>
						<th>You will be forwarded to...</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>
							<a href="https://tomdn.com/array.some">
								tomdn.com/array.some</a
							>
						</td>
						<td>
							https://developer.mozilla.org/docs/Web/Javascript/Reference/Global_Objects/Array/some
						</td>
					</tr>
					<tr>
						<td>
							<a href="https://tomdn.com/object.keys"
								>tomdn.com/object.keys</a
							>
						</td>
						<td>
							https://developer.mozilla.org/docs/Web/Javascript/Reference/Global_Objects/Object/keys
						</td>
					</tr>
					<tr>
						<td>
							<a href="https://tomdn.com/css.flex"
								>tomdn.com/css.flex</a
							>
						</td>
						<td>https://developer.mozilla.org/docs/Web/CSS/flex</td>
					</tr>
					<tr>
						<td>
							<a href="https://tomdn.com/htmlel.input"
								>tomdn.com/htmlel.input</a
							>
						</td>
						<td>
							https://developer.mozilla.org/docs/Web/HTML/Element/input
						</td>
					</tr>
					<tr>
						<td>
							<a href="https://tomdn.com/htmlattr.autofocus"
								>tomdn.com/htmlattr.autofocus</a
							>
						</td>
						<td>
							https://developer.mozilla.org/docs/Web/HTML/Global_attributes/autofocus
						</td>
					</tr>
				</tbody>
			</table>
			<p>
				That's it. So instead of googling "MDN string replace", just
				type tomdn.com/string.replace. tomdn.com will send you directly
				to the correct page on MDN from there.
			</p>
			<p>
				If the path is not known to tomdn.com, you will be sent to the
				search results page on MDN for that term.
			</p>
		</section>
		<script>
			(function () {
				// MDN will fill in the locale
				const mdnDocsBase = "https://developer.mozilla.org/docs/Web";
				const mdnSearchBase = "https://developer.mozilla.org/search?q=";
				const currentPath = window.location.pathname
					.replace("/", "")
					.toLocaleLowerCase();
				if (currentPath === "") {
					console.log("finishing");
					return;
				}

				// big list here, but not all of them map nicely to a standard url
				const browserApis = [
					"window",
					"fetch",
					"geolocation",
					"history",
					"pushmanager",
					"websocket",
					"worker",
				];
				const jsObjects = [
					// Fundamental objects
					"object",
					"function",
					"boolean",
					"symbol",
					// Numbers and dates
					"number",
					"bigint",
					"math",
					"date",
					// Text processing
					"string",
					"regexp",
					"regex",
					// Indexed collections
					"array",
					"int8array",
					"uint8array",
					"uint8clampedarray",
					"int16array",
					"uint16array",
					"int32array",
					"uint32array",
					"float32array",
					"float64array",
					"bigint64array",
					"biguint64array",
					// Keyed collections
					"map",
					"set",
					"weakmap",
					"weakset",
					// Structured data
					"arraybuffer",
					"sharedarraybuffer",
					"atomics",
					"dataview",
					"json",
					// Control abstraction objects
					"promise",
					"generator",
					"generatorfunction",
					"asyncfunction",
					// Internationalization
					"intl",
				];

				const parts = currentPath.split(".");
				if (parts[0] === "") {
					console.log("parts[0] is empty");
					return;
				}

				let url;

				if (browserApis.indexOf(parts[0] > -1)) {
					// e.g., /window.location => /API/Window/location
					url = `${mdnDocsBase}/API/${parts[0]}`;
				} else if (parts[0] === "css") {
					url = `${mdnDocsBase}/CSS`;
				} else if (jsObjects.indexOf(parts[0]) > -1) {
					// e.g., object.entries => /Javascript/Reference/Global_Objects/object/entries
					// regex is an alias for regexp
					parts[0] = parts[0] === "regex" ? "regexp" : parts[0];
					url = `${mdnDocsBase}/Javascript/Reference/Global_Objects/${parts[0]}`;
				} else if (parts[0] === "htmlel") {
					// e.g., htmlel.input => /HTML/Element/input
					// only handles html elements but could possibly handle attributes somehow
					url = `${mdnDocsBase}/HTML/Element`;
				} else if (parts[0] === "htmlattr") {
					// e.g., htmlattr.autofocus => /HTML/Global_attributes/autofocus
					// only handles html elements but could possibly handle attributes somehow
					url = `${mdnDocsBase}/HTML/Global_attributes`;
				} else if (parts[1]) {
					// if none of the parts[0] matched yet, part[0] is not something explicitly handled. Run a search on MDN.
					// e.g., parseint => https://developer.mozilla.org/search?q=parseint
					const searchTerm = encodeURI(parts[1]);
					window.location.href = `${mdnSearchBase}${searchTerm}`;
				}

				if (url && parts[1]) {
					url += `/${parts[1]}`;
				}

				if (url) {
					window.location.href = url;
				}
			})();
		</script>
	</body>
</html>
